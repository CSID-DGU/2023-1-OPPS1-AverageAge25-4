{% load static %}

<link rel="stylesheet" href="{% static 'css/MainPage.css' %}?after">
<div class="container">

    <div class="up">

        <div class="up-left">
         <img  src="{% static 'images/logo.png' %}" />
        </div>

          <div class="up-right">
           <form action="/search/" method="get">
             <input type="text" name="keyword" placeholder="검색어를 입력하세요">
             <button class="search" type="submit">검색</button>
           </form>
         </div>

    </div>
    
      <div class="middle">
       <p2>
          <button class="order" type="submit">공지사항 순서 변경</button>
       </p2>
     </div>


    <div class="down">
        <div class="menubar"  style="position: relative; left: 200px;">
            <h5>유저 키워드 확인</h5>
            <ul id="keyword-list">
                {% regroup keywords by key as grouped_keywords %}
                {% for grouped_keyword in grouped_keywords %}
                    <li>{{ grouped_keyword.grouper }} -
                        {% for keyword in grouped_keyword.list %}
                            {{ keyword.Cid.Cname }}{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    </li>
                {% endfor %}
            </ul>
            <button id="add-keyword-btn">+</button>

            <div id="keyword-input-wrapper" style="display: none;">
                <!-- 추가된 부분: 유저 키워드 입력 폼 -->
                <form id="keyword-form" action="{% url 'Login' %}" method="post">
                    {% csrf_token %}
                    <input type="text" name="keyword_name" placeholder="키워드를 입력하세요">
                    <select name="category_id">
                        {% for category in categories %}
                            <option value="{{ category.Cid }}">{{ category.Cname }}</option>
                        {% endfor %}
                    </select>
                    <button type="submit">추가</button>
                    <button id="cancel-keyword-btn" type="button">취소</button>
                </form>
            </div>
        </div>
        <div class="component-wrapper">

        {% for category in categories %}
            <div class="row{{ forloop.counter }}">
                <h5>{{ category.Cname }}</h5>
                <ul>
                {% for notice in category.notice_set.all|slice:":5" %}
                    <li><a href="{{ notice.link }}">{{ notice.title }}</a> - {{ notice.time }}</li>
                {% endfor %}
                </ul>
            </div>
        {% endfor %}

        </div>
    </div>
</div>
</link>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        var addButton = document.getElementById('add-keyword-btn');
        var cancelButton = document.getElementById('cancel-keyword-btn');
        var formWrapper = document.getElementById('keyword-input-wrapper');
        var keywordForm = document.getElementById('keyword-form');

        addButton.addEventListener('click', function() {
            addButton.style.display = 'none';
            formWrapper.style.display = 'block';
        });

        cancelButton.addEventListener('click', function() {
            addButton.style.display = 'block';
            formWrapper.style.display = 'none';
        });

        keywordForm.addEventListener('submit', function() {
            addButton.style.display = 'block';
            formWrapper.style.display = 'none';
        });
    });
</script>





